(function(){this.stopWatch=function(){return navigator.geolocation.clearWatch(cur_location)},$(document).on("ready page:change",function(){var o,t,n;if($(".hoaroutes").length>0)return t=Gmaps.build("Google"),n=null,$.get({url:"hoaroutes/getkml"},function(o){return t.buildMap({internal:{id:"geolocation"}},function(){return n=t.addPolylines(o,{strokeColor:"#cc00cc",strokeWeight:4}),t.bounds.extendWith(n),t.fitMapToBounds()})}),o=navigator.geolocation.watchPosition(function(o){var e;return e={hoaroute:{"long":o.coords.longitude,lat:o.coords.latitude}},n[0].serviceObject.getPath().push(new google.maps.LatLng(o.coords.latitude,o.coords.longitude)),t.bounds.extendWith(n),t.fitMapToBounds(),$.post({url:"hoaroutes/postroute"},e,function(o){return o})},function(){},{enableHighAccuracy:!0,timeout:100,maximumAge:0}),$(document).on("page:before-change",function(){return navigator.geolocation.clearWatch(o)})})}).call(this);